{"ast":null,"code":"import axios from 'axios';\nconst API_URL = process.env.REACT_APP_API_URL || 'http://10.5.18.69:5000';\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL || 'http://localhost:5000';\n\n// Create an Axios instance with default config\nconst api = axios.create({\n  baseURL: BACKEND_URL,\n  withCredentials: true,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor to add auth token\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('jwtToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Response interceptor for error handling\napi.interceptors.response.use(response => {\n  return response;\n}, error => {\n  console.error('API Error:', error);\n\n  // Handle 401 by redirecting to login\n  if (error.response && error.response.status === 401) {\n    localStorage.removeItem('jwtToken');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  }\n  return Promise.reject(error);\n});\n\n// API endpoints configuration\nconst apiConfig = {\n  baseURL: API_URL,\n  endpoints: {\n    // Authentication (removed unnecessary adminLogin endpoint)\n    login: '/api/auth/login',\n    register: '/api/auth/register',\n    logout: '/api/auth/logout',\n    // User-related\n    userProfile: '/api/users/profile',\n    updateProfile: '/api/users/profile/update',\n    // Location endpoints\n    userLocation: '/api/location/mylocation',\n    updateLocation: '/api/location/update',\n    busLocations: '/api/location/buses',\n    allRoutes: '/api/routes',\n    // Admin-related\n    adminBuses: '/api/admin/buses',\n    adminAddBus: '/api/admin/buses/add',\n    adminUpdateBus: id => `/api/admin/buses/${id}/update`,\n    adminDeleteBus: id => `/api/admin/buses/${id}/delete`,\n    adminStops: '/api/admin/stops',\n    adminAddStop: '/api/admin/stops/add',\n    adminUpdateStop: id => `/api/admin/stops/${id}/update`,\n    adminDeleteStop: id => `/api/admin/stops/${id}/delete`,\n    adminRoutes: '/api/admin/routes',\n    adminRouteById: id => `/api/admin/routes/${id}`,\n    adminAddRoute: '/api/admin/routes/add',\n    adminUpdateRoute: id => `/api/admin/routes/${id}/update`,\n    adminDeleteRoute: id => `/api/admin/routes/${id}/delete`,\n    adminDrivers: '/api/admin/drivers',\n    adminAddDriver: '/api/admin/drivers/add',\n    adminUpdateDriver: id => `/api/admin/drivers/${id}/update`,\n    adminDeleteDriver: id => `/api/admin/drivers/${id}/delete`,\n    adminStats: '/api/admin/statistics',\n    adminUserLocations: '/api/admin/users/locations'\n  }\n};\n\n// Helper to get API URL\nexport const getApiUrl = endpoint => {\n  if (typeof endpoint === 'function') {\n    // If endpoint is a function (like adminUpdateBus), it needs to be called with arguments\n    return `${apiConfig.baseURL}${endpoint()}`;\n  }\n\n  // Handle direct string endpoints\n  return `${apiConfig.baseURL}${endpoint}`;\n};\n\n// Helper for API calls with better error handling\nexport const callApi = async (endpoint, options = {}) => {\n  try {\n    const url = getApiUrl(endpoint);\n    const response = await axios({\n      url,\n      ...options,\n      timeout: options.timeout || 15000 // Default timeout of 15 seconds\n    });\n    return response.data;\n  } catch (error) {\n    if (error.code === 'ECONNABORTED' || error.message.includes('timeout')) {\n      console.error('API request timed out:', endpoint);\n      throw new Error('Request timed out. The server might be temporarily unavailable.');\n    }\n    throw error;\n  }\n};\nexport { apiConfig };\nexport default api;","map":{"version":3,"names":["axios","API_URL","process","env","REACT_APP_API_URL","BACKEND_URL","REACT_APP_BACKEND_URL","api","create","baseURL","withCredentials","headers","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","console","status","removeItem","window","location","href","apiConfig","endpoints","login","register","logout","userProfile","updateProfile","userLocation","updateLocation","busLocations","allRoutes","adminBuses","adminAddBus","adminUpdateBus","id","adminDeleteBus","adminStops","adminAddStop","adminUpdateStop","adminDeleteStop","adminRoutes","adminRouteById","adminAddRoute","adminUpdateRoute","adminDeleteRoute","adminDrivers","adminAddDriver","adminUpdateDriver","adminDeleteDriver","adminStats","adminUserLocations","getApiUrl","endpoint","callApi","options","url","timeout","data","code","message","includes","Error"],"sources":["/home/lubesh/Desktop/DBMS/KGP_Bus/frontend/src/utils/api.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = process.env.REACT_APP_API_URL || 'http://10.5.18.69:5000';\nconst BACKEND_URL = process.env.REACT_APP_BACKEND_URL || 'http://localhost:5000';\n\n// Create an Axios instance with default config\nconst api = axios.create({\n  baseURL: BACKEND_URL,\n  withCredentials: true,\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Request interceptor to add auth token\napi.interceptors.request.use((config) => {\n  const token = localStorage.getItem('jwtToken');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, (error) => {\n  return Promise.reject(error);\n});\n\n// Response interceptor for error handling\napi.interceptors.response.use((response) => {\n  return response;\n}, (error) => {\n  console.error('API Error:', error);\n  \n  // Handle 401 by redirecting to login\n  if (error.response && error.response.status === 401) {\n    localStorage.removeItem('jwtToken');\n    localStorage.removeItem('user');\n    window.location.href = '/login';\n  }\n  \n  return Promise.reject(error);\n});\n\n// API endpoints configuration\nconst apiConfig = {\n  baseURL: API_URL,\n  endpoints: {\n    // Authentication (removed unnecessary adminLogin endpoint)\n    login: '/api/auth/login',\n    register: '/api/auth/register',\n    logout: '/api/auth/logout',\n    \n    // User-related\n    userProfile: '/api/users/profile',\n    updateProfile: '/api/users/profile/update',\n    \n    // Location endpoints\n    userLocation: '/api/location/mylocation',\n    updateLocation: '/api/location/update',\n    busLocations: '/api/location/buses',\n    allRoutes: '/api/routes',\n    \n    // Admin-related\n    adminBuses: '/api/admin/buses',\n    adminAddBus: '/api/admin/buses/add',\n    adminUpdateBus: (id) => `/api/admin/buses/${id}/update`,\n    adminDeleteBus: (id) => `/api/admin/buses/${id}/delete`,\n    \n    adminStops: '/api/admin/stops',\n    adminAddStop: '/api/admin/stops/add',\n    adminUpdateStop: (id) => `/api/admin/stops/${id}/update`,\n    adminDeleteStop: (id) => `/api/admin/stops/${id}/delete`,\n    \n    adminRoutes: '/api/admin/routes',\n    adminRouteById: (id) => `/api/admin/routes/${id}`,\n    adminAddRoute: '/api/admin/routes/add',\n    adminUpdateRoute: (id) => `/api/admin/routes/${id}/update`,\n    adminDeleteRoute: (id) => `/api/admin/routes/${id}/delete`,\n    \n    adminDrivers: '/api/admin/drivers',\n    adminAddDriver: '/api/admin/drivers/add',\n    adminUpdateDriver: (id) => `/api/admin/drivers/${id}/update`,\n    adminDeleteDriver: (id) => `/api/admin/drivers/${id}/delete`,\n    \n    adminStats: '/api/admin/statistics',\n    adminUserLocations: '/api/admin/users/locations',\n  }\n};\n\n// Helper to get API URL\nexport const getApiUrl = (endpoint) => {\n  if (typeof endpoint === 'function') {\n    // If endpoint is a function (like adminUpdateBus), it needs to be called with arguments\n    return `${apiConfig.baseURL}${endpoint()}`;\n  }\n  \n  // Handle direct string endpoints\n  return `${apiConfig.baseURL}${endpoint}`;\n};\n\n// Helper for API calls with better error handling\nexport const callApi = async (endpoint, options = {}) => {\n  try {\n    const url = getApiUrl(endpoint);\n    const response = await axios({\n      url,\n      ...options,\n      timeout: options.timeout || 15000, // Default timeout of 15 seconds\n    });\n    return response.data;\n  } catch (error) {\n    if (error.code === 'ECONNABORTED' || error.message.includes('timeout')) {\n      console.error('API request timed out:', endpoint);\n      throw new Error('Request timed out. The server might be temporarily unavailable.');\n    }\n    throw error;\n  }\n};\n\nexport { apiConfig };\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}